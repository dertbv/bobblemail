<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Atlas Email - Your Personal Email Intelligence System{% endblock %}</title>
    
    <!-- Common CSS -->
    <link rel="stylesheet" href="/static/css/common.css">
    
    <!-- Page-specific CSS -->
    {% block extra_css %}{% endblock %}
    
    <!-- XSS Protection -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <h1>ðŸŒŸ Atlas Email</h1>
                <span class="nav-subtitle">Email Intelligence System</span>
            </div>
            <div class="nav-links">
                <a href="/" class="nav-link">Dashboard</a>
                <a href="/analytics" class="nav-link">Analytics</a>
                <a href="/accounts" class="nav-link">Accounts</a>
                <a href="/validate" class="nav-link">Validate</a>
                <a href="/report" class="nav-link">Reports</a>
                <a href="/timer" class="nav-link">Timer</a>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="main-content">
        <!-- Page Header -->
        {% block header %}
        <div class="page-header">
            <h1>{% block page_title %}Atlas Email{% endblock %}</h1>
            {% block page_subtitle %}{% endblock %}
        </div>
        {% endblock %}

        <!-- Content Container -->
        <div class="container">
            <!-- Flash Messages -->
            {% block messages %}
            {% if messages %}
            <div class="messages">
                {% for message in messages %}
                <div class="alert alert-{{ message.type }}">
                    {{ message.content | escape }}
                </div>
                {% endfor %}
            </div>
            {% endif %}
            {% endblock %}

            <!-- Main Page Content -->
            {% block content %}
            <p>Page content goes here</p>
            {% endblock %}
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Atlas Email System - Powered by ATLAS Intelligence</p>
            <div class="footer-links">
                <span>Status: {% block system_status %}Operational{% endblock %}</span>
                <span>Version: {% block version %}1.0.0{% endblock %}</span>
            </div>
        </div>
    </footer>

    <!-- Common JavaScript -->
    <script src="/static/js/common.js"></script>
    
    <!-- Page-specific JavaScript -->
    {% block extra_js %}{% endblock %}

    <!-- XSS Protection JavaScript -->
    <script>
        // Client-side HTML escaping function
        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Global error handler
        window.addEventListener('error', function(e) {
            console.error('JavaScript error:', e.error);
        });
    </script>
</body>
</html>